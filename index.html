<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a73e8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="HbeeBuzz">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiSGJlZUJ1enogLSBFbWFpbCBPdXRyZWFjaCIsInNob3J0X25hbWUiOiJIYmVlQnV6eiIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZjhmOWZhIiwidGhlbWVfY29sb3IiOiIjMWE3M2U4IiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRkFBQUFCUUNBSUFBQUNXMDFTSkFBQUFFRWxFUVZSWUdLM1o1MVlSS3dBVkFBQUEiLCJzaXplcyI6IjgweDgwIiwidHlwZSI6ImltYWdlL3BuZyJ9XX0=">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BGZ0365NTS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-BGZ0365NTS');
    </script>
  
    <!-- Primary Meta Tags -->
    <title>HbeeBuzz - Advanced Bulk Email Outreach Tool PWA</title>
    <meta name="description" content="HbeeBuzz is a lightning-fast PWA email outreach tool that works offline. Send personalized emails in bulk with smart automation and scheduling.">
    <meta name="keywords" content="HbeeBuzz, email outreach, bulk emails, PWA, offline email tool, email automation">
    <meta name="author" content="HbeeBuzz Team">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:title" content="HbeeBuzz - PWA Bulk Email Outreach Tool">
    <meta property="og:description" content="Lightning-fast PWA for bulk email outreach. Works offline with smart automation and scheduling features.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.hbeebuzz.com.ng">
    <meta property="og:image" content="https://www.hbeebuzz.com.ng/assets/images/hbeebuzz-og-image.png">
    <meta property="og:site_name" content="HbeeBuzz">
    
    <!-- Twitter Cards Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="HbeeBuzz - PWA Email Outreach Tool">
    <meta name="twitter:description" content="Lightning-fast PWA for bulk email outreach with offline capabilities and smart automation.">
    <meta name="twitter:image" content="https://www.hbeebuzz.com.ng/assets/images/hbeebuzz-twitter-image.png">
    <meta name="twitter:site" content="@hbeebuzz">
    <meta name="twitter:creator" content="@hbeebuzz">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.hbeebuzz.com.ng">

    <!-- Favicon -->
    <link rel="icon" href="https://res.cloudinary.com/dib5bkbsy/image/upload/v1732499785/icons8-mail-32_z9jaip.png" type="image/x-icon">

    <!-- Remixicon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">

    <!-- Added Google Sans font -->
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
   
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        blue: {
                            500: '#1a73e8',
                            600: '#0d62d0'
                        },
                        green: {
                            500: '#34a853'
                        },
                        yellow: {
                            500: '#fbbc05'
                        },
                        red: {
                            500: '#ea4335'
                        },
                        purple: {
                            500: '#8c5eff'
                        }
                    },
                    fontFamily: {
                        'google-sans': ['Google Sans', 'system-ui', '-apple-system', 'sans-serif'],
                        ubuntu: ['Google Sans', 'system-ui', 'sans-serif'],
                        lato: ['Google Sans', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style>
    :root {
      --blue-500: #1a73e8;
      --green: #34a853;
      --yellow: #fbbc05;
      --red-500: #ea4335;
      --purple-500: #8c5eff;
      --gray-100: #f5f5f5;
      --gray-200: #e5e5e5;
      --gray-300: #d4d4d4;
      --gray-700: #4a4a4a;
      --gray-800: #333333;
      --gray-900: #222222;
    }
    
    /* Optimized base styling */
    body {
      font-family: 'Google Sans', system-ui, -apple-system, sans-serif;
      font-size: 12px;
      font-weight: 300;
      line-height: 1.5;
      color: #202124;
      background-color: #f8f9fa;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Google Sans', system-ui, -apple-system, sans-serif;
      font-weight: 400;
      letter-spacing: -0.02em;
      line-height: 1.2;
    }

    h1 { font-size: 2rem; font-weight: 700; }
    h2 { font-size: 1.5rem; font-weight: 600; }
    h3 { font-size: 1.25rem; font-weight: 600; }
    h4 { font-size: 1.125rem; font-weight: 500; }
  
    .dark-custom-bg { background-color: #202124; }
    .dark .bg-card { background-color: #202124; }

    /* Ultra-lightweight scrollbar */
    ::-webkit-scrollbar { width: 4px; height: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.2); border-radius: 2px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(0, 0, 0, 0.3); }
    .dark ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); }
    .dark ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.3); }
    
    /* Lightning-fast email links */
    .email-link {
      padding: 3px 5px;
      border-radius: 4px;
      margin-bottom: 2px;
      font-size: 12px;
      font-weight: 400;
      transition: background-color 0.1s ease;
      display: block;
    }
      
    /* Optimized button styles */
    .gmail-btn {
      background-color: var(--blue-500);
      color: white;
      border-radius: 6px;
      font-family: 'Google Sans', system-ui, sans-serif;
      font-weight: 500;
      font-size: 14px;
      letter-spacing: 0.01em;
      text-transform: none;
      box-shadow: 0 1px 3px rgba(60, 64, 67, 0.15);
      transition: all 0.15s ease;
      border: none;
      cursor: pointer;
    }

    .gmail-btn:hover {
      background-color: #0d62d0;
      transform: translateY(-1px);
    }
    
    .gmail-btn:active { transform: translateY(0); }
    .gmail-btn:disabled {
      background-color: #dadce0;
      color: #5f6368;
      cursor: not-allowed;
      transform: none;
    }
    
    .gmail-btn-secondary {
      background-color: white;
      color: var(--blue-500);
      border: 1px solid #dadce0;
      font-family: 'Google Sans', system-ui, sans-serif;
      font-weight: 500;
      transition: all 0.15s ease;
    }
    
    .gmail-btn-secondary:hover {
      background-color: #f8f9fa;
      border-color: var(--blue-500);
    }
    
    .dark .gmail-btn-secondary {
      background-color: #2d2e30;
      color: #8ab4f8;
      border-color: #5f6368;
    }
    
    .dark .gmail-btn-secondary:hover {
      background-color: #3c4043;
      border-color: #8ab4f8;
    }
    
    /* Ultra-fast focus effects */
    .focus-effect:focus {
      border-color: var(--blue-500) !important;
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.12);
      outline: none;
    }

    /* Optimized theme slider */
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #dadce0;
      transition: all 0.2s ease;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: all 0.2s ease;
      border-radius: 50%;
    }

    input:checked + .slider { background-color: var(--blue-500); }
    input:checked + .slider:before { transform: translateX(26px); }

    #themeMenu { transition: all 0.15s ease; }
   
    /* Optimized textarea */
    textarea {
      font-family: 'Google Sans', system-ui, sans-serif;
      font-size: 14px;
      line-height: 1.5;
      scrollbar-width: thin;
      scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
    }

    .dark textarea { scrollbar-color: rgba(255, 255, 255, 0.2) transparent; }
    
    /* Lightning-fast card styling */
    .gmail-card {
      background-color: white;
      border-radius: 12px;
      border: 1px solid rgba(0, 0, 0, 0.04);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
      transition: box-shadow 0.2s ease;
    }
    
    .gmail-card:hover { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
    .dark .gmail-card {
      background-color: #2d2e30;
      border-color: rgba(255, 255, 255, 0.06);
    }

    /* Optimized input styling */
    .gmail-input {
      border-radius: 8px;
      border: 1px solid #dadce0;
      padding: 10px 14px;
      font-family: 'Google Sans', system-ui, sans-serif;
      font-size: 14px;
      font-weight: 400;
      transition: all 0.15s ease;
      background-color: white;
    }
    
    .gmail-input:focus {
      border-color: var(--blue-500);
      outline: none;
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.12);
    }
    
    .dark .gmail-input {
      border-color: #5f6368;
      background-color: #2d2e30;
      color: #e8eaed;
    }
    
    /* Optimized template chips */
    .template-chip {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      background-color: #f0f4f9;
      color: var(--blue-500);
      border-radius: 20px;
      font-family: 'Google Sans', system-ui, sans-serif;
      font-size: 13px;
      font-weight: 500;
      margin-right: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.15s ease;
      border: 1px solid transparent;
    }
    
    .template-chip:hover {
      background-color: #e4ebf5;
      border-color: var(--blue-500);
    }
    
    .dark .template-chip {
      background-color: #3c4043;
      color: #8ab4f8;
    }
    
    .dark .template-chip:hover {
      background-color: #4a4e51;
      border-color: #8ab4f8;
    }
    
    /* Super-fast floating button */
    .floating-btn {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background-color: var(--blue-500);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
      cursor: pointer;
      transition: all 0.2s ease;
      z-index: 100;
      opacity: 0;
      transform: scale(0);
      border: none;
    }
    
    .floating-btn.visible {
      opacity: 1;
      transform: scale(1);
    }
    
    .floating-btn:hover {
      background-color: #0d62d0;
      transform: scale(1.05);
    }
    
    /* Email validation indicators */
    .validation-indicator {
      display: inline-flex;
      align-items: center;
      padding: 3px 8px;
      border-radius: 12px;
      font-family: 'Google Sans', system-ui, sans-serif;
      font-size: 12px;
      font-weight: 500;
      margin-right: 8px;
    }
    
    .validation-good {
      background-color: rgba(52, 168, 83, 0.1);
      color: #34a853;
    }
    
    .validation-bad {
      background-color: rgba(234, 67, 53, 0.1);
      color: #ea4335;
    }
    
    .dark .validation-good { background-color: rgba(52, 168, 83, 0.2); }
    .dark .validation-bad { background-color: rgba(234, 67, 53, 0.2); }
    
    /* Ultra-fast animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    .animate-fadeIn { animation: fadeIn 0.2s ease forwards; }
    .animate-slideIn { animation: slideIn 0.2s ease forwards; }
    
    /* Performance optimizations */
    .email-container {
      contain: layout style paint;
    }
    
    .smooth-scroll {
      transform: translateZ(0);
      scroll-behavior: smooth;
    }

    /* Lightning-fast loading states */
    .loading-skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1s infinite;
    }

    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .dark .loading-skeleton {
      background: linear-gradient(90deg, #2a2a2a 25%, #3a3a3a 50%, #2a2a2a 75%);
      background-size: 200% 100%;
    }

    /* Global progress bar */
    #globalProgressBar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background-color: #e0e0e0;
      z-index: 9999;
      transform: translateY(-100%);
      transition: transform 0.2s ease;
    }
    #globalProgressBar.show { transform: translateY(0); }
    #globalProgressBar .progress-bar {
      height: 100%;
      width: 0%;
      background-color: var(--green);
      transition: width 0.1s linear;
    }

    /* Email links multi-select */
    .email-link.selected {
      background-color: rgba(26, 115, 232, 0.1);
      border-left: 3px solid var(--blue-500);
      padding-left: 3px;
    }

    /* Search bar styles */
    .search-container {
      background: linear-gradient(135deg, rgba(26, 115, 232, 0.1), rgba(52, 168, 83, 0.05));
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(26, 115, 232, 0.1);
    }

    /* Automation panel */
    .automation-panel {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    /* Smart suggestion chips */
    .smart-chip {
      background: linear-gradient(135deg, #ff9a56, #ff6b6b);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 25px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      margin: 4px;
    }

    .smart-chip:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); }

    /* PWA Installation prompt */
    .install-prompt {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 20px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Offline indicator */
    .offline-indicator {
      position: fixed;
      top: 60px;
      right: 20px;
      background: #ff6b6b;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 12px;
      z-index: 1000;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }

    .offline-indicator.show { transform: translateX(0); }

    /* Quick actions toolbar */
    .quick-actions {
      position: fixed;
      top: 50%;
      right: -200px;
      transform: translateY(-50%);
      background: white;
      border-radius: 12px 0 0 12px;
      box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
      padding: 12px 8px;
      transition: right 0.3s ease;
      z-index: 90;
    }

    .quick-actions.show { right: 0; }
    .dark .quick-actions { background: #2d2e30; }

    /* Performance metrics */
    .perf-meter {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: conic-gradient(#34a853 0deg 120deg, #fbbc05 120deg 240deg, #ea4335 240deg 360deg);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .perf-meter::before {
      content: '';
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: white;
      position: absolute;
    }

    .dark .perf-meter::before { background: #2d2e30; }
    
    /* 24h Tracker Styles */
    #24hProgressBar {
      transition: width 0.3s ease;
    }

    #summaryPanel {
      animation: slideIn 0.2s ease forwards;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    #summaryPanel.show {
      max-height: 300px;
    }

    /* Enhanced Message Body Editor Styles */
    .editor-tabs {
      display: flex;
      border-bottom: 1px solid #dadce0;
      background: #f8f9fa;
      border-radius: 8px 8px 0 0;
    }

    .editor-tab {
      padding: 12px 20px;
      cursor: pointer;
      border: none;
      background: transparent;
      font-family: 'Google Sans', system-ui, sans-serif;
      font-size: 14px;
      font-weight: 500;
      color: #5f6368;
      transition: all 0.2s ease;
      border-bottom: 2px solid transparent;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .editor-tab.active {
      color: var(--blue-500);
      border-bottom-color: var(--blue-500);
      background: white;
    }

    .dark .editor-tab {
      color: #9aa0a6;
      background: #2d2e30;
    }

    .dark .editor-tab.active {
      color: #8ab4f8;
      background: #202124;
    }

    .editor-panel {
      display: none;
      padding: 0;
    }

    .editor-panel.active {
      display: block;
    }

    /* HTML Editor Styles */
    #htmlEditor {
      width: 100%;
      height: 300px;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 14px;
      line-height: 1.5;
      border: 1px solid #dadce0;
      border-radius: 0 0 8px 8px;
      padding: 12px;
      resize: vertical;
      background: #f8f9fa;
      color: #202124;
    }

    .dark #htmlEditor {
      background: #1e1e1e;
      color: #d4d4d4;
      border-color: #5f6368;
    }

    .html-toolbar {
      display: flex;
      gap: 8px;
      padding: 8px;
      background: #f1f3f4;
      border-bottom: 1px solid #dadce0;
    }

    .dark .html-toolbar {
      background: #2d2e30;
      border-color: #5f6368;
    }

    .html-snippet {
      background: #e8f0fe;
      border: 1px solid #dadce0;
      border-radius: 4px;
      padding: 8px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .html-snippet:hover {
      background: #d2e3fc;
    }

    .dark .html-snippet {
      background: #3c4043;
      border-color: #5f6368;
      color: #e8eaed;
    }

    /* Live Preview Styles */
    .preview-container {
      border: 1px solid #dadce0;
      border-radius: 0 0 8px 8px;
      background: white;
      height: 300px;
      overflow: auto;
    }

    .dark .preview-container {
      background: #202124;
      border-color: #5f6368;
    }

    .preview-toolbar {
      display: flex;
      gap: 8px;
      padding: 8px;
      background: #f1f3f4;
      border-bottom: 1px solid #dadce0;
    }

    .dark .preview-toolbar {
      background: #2d2e30;
      border-color: #5f6368;
    }

    .preview-device {
      padding: 4px 12px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
      background: white;
    }

    .preview-device.active {
      background: var(--blue-500);
      color: white;
      border-color: var(--blue-500);
    }

    .dark .preview-device {
      background: #3c4043;
      border-color: #5f6368;
      color: #e8eaed;
    }

    .preview-content {
      padding: 20px;
      min-height: 200px;
    }

    /* Enhanced Rich Text Editor */
    .enhanced-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      padding: 8px;
      background: #f8f9fa;
      border-bottom: 1px solid #dadce0;
    }

    .dark .enhanced-toolbar {
      background: #2d2e30;
      border-color: #5f6368;
    }

    .toolbar-group {
      display: flex;
      gap: 2px;
      padding: 0 8px;
      border-right: 1px solid #dadce0;
    }

    .dark .toolbar-group {
      border-right-color: #5f6368;
    }

    .toolbar-group:last-child {
      border-right: none;
    }

    .toolbar-btn {
      padding: 6px 8px;
      border: none;
      background: transparent;
      border-radius: 4px;
      cursor: pointer;
      color: #5f6368;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .toolbar-btn:hover {
      background: #e8f0fe;
      color: var(--blue-500);
    }

    .dark .toolbar-btn {
      color: #9aa0a6;
    }

    .dark .toolbar-btn:hover {
      background: #3c4043;
      color: #8ab4f8;
    }

    .toolbar-btn.active {
      background: var(--blue-500);
      color: white;
    }

    .color-picker {
      width: 24px;
      height: 24px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      cursor: pointer;
    }

    .font-select {
      padding: 4px 8px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      background: white;
      font-size: 12px;
    }

    .dark .font-select {
      background: #3c4043;
      border-color: #5f6368;
      color: #e8eaed;
    }

    /* Component Library */
    .component-library {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 8px;
      padding: 12px;
      background: #f8f9fa;
      border-bottom: 1px solid #dadce0;
    }

    .dark .component-library {
      background: #2d2e30;
      border-color: #5f6368;
    }

    .component-item {
      padding: 12px;
      border: 1px solid #dadce0;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s ease;
    }

    .component-item:hover {
      border-color: var(--blue-500);
      transform: translateY(-2px);
    }

    .dark .component-item {
      background: #3c4043;
      border-color: #5f6368;
      color: #e8eaed;
    }

    .component-icon {
      font-size: 20px;
      margin-bottom: 4px;
      color: var(--blue-500);
    }

    /* Gmail Compatibility Warnings */
    .compatibility-warning {
      background: #fef7e0;
      border: 1px solid #fbbc05;
      border-radius: 4px;
      padding: 8px 12px;
      margin: 8px 0;
      font-size: 12px;
      color: #5f6368;
    }

    .dark .compatibility-warning {
      background: #3c2e00;
      border-color: #fbbc05;
      color: #fbbc05;
    }

    .warning-icon {
      color: #fbbc05;
      margin-right: 8px;
    }

    /* Mobile Preview Frame */
    .mobile-preview {
      width: 375px;
      height: 667px;
      border: 12px solid #333;
      border-radius: 24px;
      background: white;
      overflow: hidden;
      margin: 0 auto;
      position: relative;
    }

    .mobile-preview::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 4px;
      background: #333;
      border-radius: 0 0 4px 4px;
    }

    .mobile-preview-content {
      height: 100%;
      overflow-y: auto;
      padding: 16px;
    }

    /* Test Email Modal */
    .test-email-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .test-email-content {
      background: white;
      border-radius: 12px;
      padding: 24px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .dark .test-email-content {
      background: #2d2e30;
    }

    /* Syntax Highlighting */
    .token.tag { color: #22863a; }
    .token.attr-name { color: #6f42c1; }
    .token.attr-value { color: #032f62; }
    .token.punctuation { color: #24292e; }
    .dark .token.tag { color: #7ee787; }
    .dark .token.attr-name { color: #ff7b72; }
    .dark .token.attr-value { color: #79c0ff; }
    .dark .token.punctuation { color: #c9d1d9; }
    </style>
    
    <style>
  .scrolling-text {
    width: 100%;
    overflow: hidden;
  }
  .scrolling-text p {
    animation: scroll-left 15s linear infinite;
  }
  @keyframes scroll-left {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }
</style>
   
<link rel="me" href="https://www.blogger.com/profile/03086539832299890802" />
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

<script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>

</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen flex flex-col">

    <!-- Global Progress Bar -->
    <div id="globalProgressBar">
        <div class="progress-bar"></div>
    </div>

    <!-- Offline Indicator -->
    <div id="offlineIndicator" class="offline-indicator">
        <i class="ri-wifi-off-line mr-2"></i>
        Working Offline
    </div>

    <!-- PWA Install Prompt -->
    <div id="installPrompt" class="install-prompt fixed top-4 left-4 right-4 mx-auto max-w-md z-50 hidden">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <i class="ri-download-cloud-line text-xl mr-3"></i>
                <div>
                    <div class="font-semibold">Install HbeeBuzz</div>
                    <div class="text-sm opacity-90">Get the full app experience</div>
                </div>
            </div>
            <div class="flex gap-2">
                <button id="installBtn" class="bg-white text-purple-600 px-4 py-2 rounded-lg text-sm font-medium">Install</button>
                <button id="dismissInstall" class="text-white opacity-75 hover:opacity-100">
                    <i class="ri-close-line text-xl"></i>
                </button>
            </div>
        </div>
    </div>

<!-- Header Section -->
<header class="bg-white dark:bg-gray-800 py-4 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50">
  <div class="container mx-auto flex justify-between items-center px-4 md:px-6">

    <!-- Branding Section -->
    <div class="flex items-center space-x-4">
      <div class="flex items-center space-x-3">
        <img src="https://res.cloudinary.com/dib5bkbsy/image/upload/v1732499785/icons8-mail-32_z9jaip.png" alt="HbeeBuzz Logo" class="w-6 h-6">
        <h1 class="text-2xl font-bold" style="color:#4CAF50;">HbeeBuzz</h1>
        <span class="text-xs px-2 py-1 rounded-full font-medium" style="background-color:#FF5722; color:#FFEB3B;">
          PWA
        </span>
      </div>
    </div>


      <!-- Social Links & Performance -->
      <div class="flex justify-center items-center gap-4">
        <div class="perf-meter hidden md:flex">
          <span id="perfScore" class="text-xs font-bold z-10">98</span>
        </div>
        <a href="https://www.x.com/justeldev" class="text-black dark:text-gray-400 hover:text-blue-500 transition-all p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full">
          <i class="ri-twitter-x-fill text-xl"></i>
        </a>
      </div>
      
      <!-- Stats & Theme Toggle -->
      <div class="flex items-center space-x-4">
        <div class="hidden md:flex items-center space-x-6 mr-4">
          <div class="flex items-center space-x-2">
            <i class="ri-check-double-line text-green-500"></i>
            <span class="text-sm font-medium"><span id="headerSentCount" class="font-semibold">0</span> sent</span>
          </div>
          <div class="flex items-center space-x-2">
            <i class="ri-time-line text-blue-500"></i>
            <span class="text-sm font-medium"><span id="headerRemainingCount" class="font-semibold">0</span> pending</span>
          </div>
        </div>

        <div class="relative">
          <button id="darkModeToggle" class="text-blue-500 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
            <i class="ri-moon-line ri-lg hidden" id="darkIcon"></i>
            <i class="ri-sun-line ri-lg" id="lightIcon"></i>
          </button>

          <ul id="themeMenu" class="absolute right-0 top-11 mt-2 w-48 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 shadow-lg rounded-lg opacity-0 invisible transition-all duration-300 z-50 border border-gray-200 dark:border-gray-700">
            <li data-theme="system" class="p-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded-t-lg flex items-center gap-2">
              <i class="ri-device-line text-green-500"></i> System
            </li>
            <li data-theme="light" class="p-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex items-center gap-2">
              <i class="ri-sun-line text-yellow-500"></i> Light
            </li>
            <li data-theme="dark" class="p-3 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer rounded-b-lg flex items-center gap-2">
              <i class="ri-moon-line text-blue-500"></i> Dark
            </li>
          </ul>
        </div>
      </div>
    </div>
  </header>


<!-- Announcement Bar Section -->
<section class="bg-orange-50 border border-orange-200 rounded-xl text-orange-700 p-2 text-center flex items-center justify-between mx-2 mt-3 shadow-sm">
  
  <!-- Icon + Scrolling Text -->
  <div class="flex items-center overflow-hidden">
    <i class="ri-megaphone-line text-lg mr-2 text-orange-500"></i>
    <div class="scrolling-text whitespace-nowrap">
      <p id="announcementText" class="inline-block px-2">
       HbeeBuzz Update <i class="ri-alert-line text-red-500"></i>: Now works offline with PWA, global email search, AI commands, smart automation, spam check, live activity, and reset campaign features.
      </p>
    </div>
  </div>

  <!-- Copy Button -->
  <button onclick="copyAnnouncement()" 
          class="ml-3 px-2 py-1 rounded-lg text-sm flex items-center gap-1 text-orange-600 hover:bg-orange-100 transition">
    <i class="ri-file-copy-line"></i> Copy
  </button>
</section>



<script>
  function copyAnnouncement() {
    const text = document.getElementById("announcementText").innerText;
    navigator.clipboard.writeText(text).then(() => {
      alert("Announcement copied!");
    });
  }
</script>

<!-- Search Bar Section -->
<div class="search-container py-4 sticky top-16 z-40">
  <div class="container mx-auto px-4">
    <div class="relative max-w-2xl mx-auto">
      <div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden shadow-sm focus-within:ring-2 focus-within:ring-blue-500 transition-all bg-white dark:bg-gray-800">
        <i class="ri-search-line px-4 text-gray-400 dark:text-gray-500 text-xl flex-shrink-0"></i>
        
        <input 
          type="text" 
          id="globalEmailSearch" 
          placeholder="Search emails globally or use AI commands..." 
          class="flex-1 min-w-0 px-3 py-4 bg-transparent focus:outline-none text-gray-700 dark:text-gray-300 focus-effect"
        />
        
        <div class="px-3 flex items-center space-x-2 flex-shrink-0">
          <button id="aiAssistBtn" class="smart-chip">
            <i class="ri-sparkling-line mr-1"></i> AI
          </button>
          
        </div>
      </div>
      
      <!-- Search Suggestions -->
      <div id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg mt-2 hidden z-50">
        <div class="p-4 space-y-2">
          <div class="text-xs font-medium text-gray-500 dark:text-gray-400 mb-2">AI Commands</div>
          <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="find:gmail">Find all Gmail addresses</button>
          <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="sort:domain">Sort by domain</button>
          <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="filter:unsent">Show only unsent</button>
          <button class="w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" data-command="export:csv">Export as CSV</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Quick Actions Toolbar -->
<div id="quickActions" class="quick-actions">
  <div class="flex flex-col gap-3">
    <button id="quickSchedule" class="p-3 rounded-full bg-purple-500 text-white hover:bg-purple-600 transition-colors" title="Quick Schedule">
      <i class="ri-calendar-schedule-line"></i>
    </button>
    <button id="quickExport" class="p-3 rounded-full bg-green-500 text-white hover:bg-green-600 transition-colors" title="Quick Export">
      <i class="ri-download-cloud-line"></i>
    </button>
    <button id="quickStats" class="p-3 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors" title="Quick Stats">
      <i class="ri-bar-chart-line"></i>
    </button>
    <button id="toggleQuickActions" class="p-2 rounded-full bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300">
      <i class="ri-arrow-right-line" id="quickActionsIcon"></i>
    </button>
  </div>
</div>


  <!-- Main Container -->
  <div class="container mx-auto px-4 flex-grow py-6">

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
      
      <!-- Left Column (3/4) -->
      <div class="lg:col-span-3 space-y-6">

       

        <!-- Main Tool Form -->
        <div class="gmail-card p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-bold flex items-center gap-2 text-green-500 dark:text-gray-100">
              <i class="ri-send-plane-fill text-red-500"></i>
              Fast Mail Send
            </h2>
            <div class="flex items-center gap-2">
              <span class="text-sm text-blue-500 dark:text-blue-400 font-medium">Status:</span>
              <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
            </div>
          </div>

          <form id="emailForm" class="space-y-5">
            <!-- Recipients Section -->
            <div>
              <label for="recipients" class="block text-sm font-medium flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2">
                <i class="ri-mail-line text-blue-500"></i>
                Recipients Email <small class="ml-2 text-xs text-gray-500 dark:text-gray-400">(Max 10,000)</small>
                <button type="button" id="smartExtract" class="smart-chip ml-auto text-xs">
                  <i class="ri-magic-line mr-1"></i> AI Smart Fix
                </button>
              </label>
              <div class="relative">
                <textarea
                  id="recipients"
                  class="w-full gmail-input resize-none focus-effect"
                  rows="5"
                  placeholder="Enter each email on a new line or paste mixed content for smart extraction"
                  required
                ></textarea>
                <div class="absolute bottom-2 right-2 flex gap-2">
                  <button type="button" id="clearRecipients" class="text-xs text-red-500 hover:text-red-700">
                    <i class="ri-close-circle-line"></i> Clear
                  </button>
                  <button type="button" id="validateEmails" class="text-xs text-blue-500 hover:text-blue-700">
                    <i class="ri-shield-check-line"></i> Validate
                  </button>
                </div>
              </div>
              
              <div class="flex flex-wrap items-center mt-2 text-xs text-gray-600 dark:text-gray-400">
                <div id="validEmailsIndicator" class="validation-indicator validation-good mr-2 mb-1">
                  <i class="ri-checkbox-circle-line mr-1"></i>
                  <span>Valid: <span id="validEmails" class="font-medium">0</span></span>
                </div>
                <div id="invalidEmailsIndicator" class="validation-indicator validation-bad mr-2 mb-1">
                  <i class="ri-error-warning-line mr-1"></i>
                  <span>Invalid: <span id="invalidEmails" class="font-medium">0</span></span>
                </div>
                <div class="mr-2 mb-1">
                  <span>Total: <span id="totalEmails" class="font-medium">0</span></span>
                </div>
                <div class="mr-2 mb-1">
                  <span>Duplicates: <span id="duplicateEmails" class="font-medium text-yellow-600">0</span></span>
                </div>
              </div>
            </div>

            <!-- Subject Section -->
            <div>
              <label for="subject" class="block text-sm font-medium flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2">
                <i class="ri-pencil-line text-yellow-500"></i>
                Subject Line <small class="ml-2 text-xs text-gray-500 dark:text-gray-400">(Max 200 characters)</small>
                
              </label>
              <input
                type="text"
                id="subject"
                class="w-full gmail-input focus-effect"
                placeholder="Email Subject - Use {name} for personalization"
              />
              
              <!-- Subject Templates -->
              <div class="flex flex-wrap mt-2">
                <div class="template-chip" data-target="subject" data-template="Quick question about {company}">
                  <i class="ri-question-line mr-1"></i> Quick question
                </div>
                <div class="template-chip" data-target="subject" data-template="Partnership opportunity with {name}">
                  <i class="ri-handshake-line mr-1"></i> Partnership
                </div>
                <div class="template-chip" data-target="subject" data-template="Exclusive offer for {company}">
                  <i class="ri-gift-line mr-1"></i> Exclusive offer
                </div>
              </div>
              
              <div class="flex justify-between mt-1">
                <div class="flex gap-2">
                <button type="button" id="subjectAnalyzer" class="gmail-btn-secondary py-1 px-3 text-xs flex items-center gap-1 relative">
  <i class="ri-search-eye-line"></i> Analyze
  <span class="absolute -top-2 -right-2 text-[10px] font-bold bg-gradient-to-r from-green-400 to-blue-500 text-transparent bg-clip-text">
    NEW
  </span>
</button>

<button type="button" id="spamChecker" class="gmail-btn-secondary py-1 px-3 text-xs flex items-center gap-1 relative">
  <i class="ri-shield-line"></i> Spam Check
  <span class="absolute -top-2 -right-2 text-[10px] font-bold bg-gradient-to-r from-pink-500 to-yellow-500 text-transparent bg-clip-text">
    NEW
  </span>
</button>
                </div>
                <span id="subjectCount" class="text-xs text-gray-500 dark:text-gray-400">0/200</span>
              </div>
            </div>

            <!-- Enhanced Message Body Section with Three-Mode Editor -->
            <div>
              <label class="block text-sm font-medium flex items-center gap-2 text-gray-700 dark:text-gray-300 mb-2">
                <i class="ri-file-text-line text-green-500"></i>
                Message Body <small class="ml-2 text-xs text-gray-500 dark:text-gray-400">(Rich Text & HTML Support)</small>
                <div class="flex gap-1 ml-auto">
                  <button type="button" id="toggleEditor" class="gmail-btn-secondary py-1 px-3 text-xs flex items-center gap-1">
                    <i class="ri-code-s-slash-line"></i> Toggle Editor
                  </button>
                </div>
              </label>

              <!-- Three-Mode Editor Tabs -->
              <div class="editor-tabs">
                <button class="editor-tab active" data-tab="text">
                  <i class="ri-text-wrap"></i> Text Editor
                </button>
                <button class="editor-tab" data-tab="html">
                  <i class="ri-code-s-slash-line"></i> HTML Code
                </button>
                <button class="editor-tab" data-tab="preview">
                  <i class="ri-eye-line"></i> Live Preview
                </button>
              </div>

              <!-- Text Editor Panel -->
              <div class="editor-panel active" id="textPanel">
                <!-- Enhanced Rich Text Toolbar -->
                <div class="enhanced-toolbar">
                  <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="bold" title="Bold">
                      <i class="ri-bold"></i>
                    </button>
                    <button class="toolbar-btn" data-command="italic" title="Italic">
                      <i class="ri-italic"></i>
                    </button>
                    <button class="toolbar-btn" data-command="underline" title="Underline">
                      <i class="ri-underline"></i>
                    </button>
                  </div>
                  
                  <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="justifyLeft" title="Align Left">
                      <i class="ri-align-left"></i>
                    </button>
                    <button class="toolbar-btn" data-command="justifyCenter" title="Center">
                      <i class="ri-align-center"></i>
                    </button>
                    <button class="toolbar-btn" data-command="justifyRight" title="Align Right">
                      <i class="ri-align-right"></i>
                    </button>
                  </div>
                  
                  <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                      <i class="ri-list-unordered"></i>
                    </button>
                    <button class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                      <i class="ri-list-ordered"></i>
                    </button>
                  </div>
                  
                  <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="createLink" title="Insert Link">
                      <i class="ri-link"></i>
                    </button>
                    <button class="toolbar-btn" data-command="unlink" title="Remove Link">
                      <i class="ri-link-unlink"></i>
                    </button>
                  </div>
                  
                  <div class="toolbar-group">
                    <select class="font-select" id="fontFamily">
                      <option value="Arial">Arial</option>
                      <option value="Helvetica">Helvetica</option>
                      <option value="Georgia">Georgia</option>
                      <option value="Times New Roman">Times New Roman</option>
                      <option value="Verdana">Verdana</option>
                    </select>
                    <select class="font-select" id="fontSize">
                      <option value="1">Small</option>
                      <option value="3" selected>Normal</option>
                      <option value="5">Large</option>
                      <option value="7">Huge</option>
                    </select>
                  </div>
                  
                  <div class="toolbar-group">
                    <input type="color" class="color-picker" id="textColor" value="#000000" title="Text Color">
                    <input type="color" class="color-picker" id="backgroundColor" value="#ffffff" title="Background Color">
                  </div>
                </div>

                <!-- Component Library -->
                <div class="component-library">
                  <div class="component-item" data-component="button">
                    <i class="ri-checkbox-blank-circle-line component-icon"></i>
                    <div>Button</div>
                  </div>
                  <div class="component-item" data-component="image">
                    <i class="ri-image-line component-icon"></i>
                    <div>Image</div>
                  </div>
                  <div class="component-item" data-component="divider">
                    <i class="ri-separator component-icon"></i>
                    <div>Divider</div>
                  </div>
                  <div class="component-item" data-component="social">
                    <i class="ri-share-line component-icon"></i>
                    <div>Social Icons</div>
                  </div>
                  <div class="component-item" data-component="table">
                    <i class="ri-table-line component-icon"></i>
                    <div>Table</div>
                  </div>
                  <div class="component-item" data-component="quote">
                    <i class="ri-double-quotes-l component-icon"></i>
                    <div>Quote</div>
                  </div>
                </div>

                <!-- Rich Text Editor -->
                <div 
                  id="richTextEditor" 
                  class="w-full gmail-input resize-none focus-effect"
                  contenteditable="true"
                  style="border-top: none; border-radius: 0 0 8px 8px; min-height: 200px;"
                ></div>
              </div>

              <!-- HTML Editor Panel -->
              <div class="editor-panel" id="htmlPanel">
                <div class="html-toolbar">
                  <button class="html-snippet" data-snippet="button">Insert Button</button>
                  <button class="html-snippet" data-snippet="layout">Basic Layout</button>
                  <button class="html-snippet" data-snippet="table">Insert Table</button>
                  <button class="html-snippet" data-snippet="image">Image Template</button>
                  <button class="html-snippet" id="formatHTML">Format Code</button>
                  <button class="html-snippet" id="validateHTML">Validate</button>
                </div>
                <textarea
                  id="htmlEditor"
                  placeholder="Paste your HTML code here or use the templates above..."
                  spellcheck="false"
                ></textarea>
                <div class="compatibility-warning">
                  <i class="ri-alert-line warning-icon"></i>
                  Some CSS styles may not render correctly in Gmail. Use inline styles for best compatibility.
                </div>
              </div>

              <!-- Live Preview Panel -->
              <div class="editor-panel" id="previewPanel">
                <div class="preview-toolbar">
                  <button class="preview-device active" data-device="desktop">Desktop</button>
                  <button class="preview-device" data-device="mobile">Mobile</button>
                  <button class="preview-device" data-device="gmail">Gmail View</button>
                  <button class="gmail-btn-secondary ml-auto text-xs" id="sendTestPreview">Send Test</button>
                </div>
                <div class="preview-container">
                  <div class="preview-content" id="livePreview">
                    <p class="text-gray-500 text-center">Preview will appear here...</p>
                  </div>
                </div>
              </div>

              <!-- Body Templates -->
              <div class="flex flex-wrap mt-2">
                <div class="template-chip" data-target="body" data-template="Hi {name},&#10;&#10;I hope this email finds you well. I wanted to reach out about an exciting opportunity that could benefit {company}.&#10;&#10;Would you be available for a quick 15-minute call this week?&#10;&#10;Best regards,&#10;[Your Name]">
                  <i class="ri-chat-1-line mr-1"></i> Professional
                </div>
                <div class="template-chip" data-target="body" data-template="Hello {name},&#10;&#10;I noticed your work at {company} and was impressed by your recent achievements. I'd love to discuss how we could potentially collaborate.&#10;&#10;Are you free for a coffee chat next week?&#10;&#10;Cheers,&#10;[Your Name]">
                  <i class="ri-user-voice-line mr-1"></i> Casual
                </div>
                <div class="template-chip" data-target="body" data-template="Dear {name},&#10;&#10;I'm writing to invite you to our exclusive event happening next month. Given {company}'s reputation in the industry, your presence would be invaluable.&#10;&#10;Please find the details attached.&#10;&#10;Warm regards,&#10;[Your Name]">
                  <i class="ri-calendar-event-line mr-1"></i> Invitation
                </div>
              </div>
              
              <div class="flex justify-between items-center mt-2">
                <div class="text-xs text-blue-600 dark:text-blue-400 flex items-center gap-4">
                  <span id="editorStatus">
                    <i class="ri-text-wrap"></i> Text Editor Mode
                  </span>
                  <div class="flex items-center gap-1">
                    <span id="mobilePreviewStatus" class="hidden text-green-600">
                      <i class="ri-smartphone-line"></i> Mobile Optimized
                    </span>
                  </div>
                </div>
                <span id="bodyCount" class="text-xs text-gray-500 dark:text-gray-400">0/5000</span>
              </div>
            </div>

            <!-- Advanced Options -->
            <div class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4">
              <div class="flex items-center justify-between mb-3">
                <h4 class="font-medium text-gray-800 dark:text-gray-200 relative inline-block">
  Advanced Options
  <span class="absolute -top-2 -right-6 text-[10px] font-bold bg-gradient-to-r from-pink-500 to-red-500 text-transparent bg-clip-text">
    NEW
  </span>
</h4>
<button type="button" id="toggleAdvanced" class="text-xs text-blue-500 hover:text-blue-700">
  <i class="ri-arrow-down-s-line" id="advancedIcon"></i> Expand
</button>
              </div>
              <div id="advancedOptions" class="hidden space-y-4">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
     
     <!-- Instruction Block -->
<div class="bg-yellow-50 dark:bg-yellow-900 border-l-4 border-yellow-400 p-3 mb-3 rounded">
  <div class="flex items-start gap-2 text-sm text-gray-700 dark:text-gray-300">
    <i class="ri-information-line text-yellow-500 dark:text-yellow-300 text-lg"></i>
    <p>
      To use this feature, first scroll down and enable 
      <span class="font-medium text-gray-800 dark:text-gray-100">"Enable Auto-Send"</span>.  
      After enabling, allow pop-ups in your browser.  
      Then return here, customize the settings, and click 
      <span class="font-medium text-gray-800 dark:text-gray-100">"Generate Emails"</span>.  
      Emails will send automatically without manual clicks.
    </p>
  </div>
</div>
      <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Send Interval (seconds)</label>
      <input type="number" id="sendInterval" class="gmail-input w-full" value="10" min="1" max="300">
    </div>

    <div>
      <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Batch Size</label>
      <input type="number" id="batchSize" class="gmail-input w-full" value="50" min="10" max="500">
    </div>

    <div>
      <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Priority Mode</label>
      <select id="priorityMode" class="gmail-input w-full">
        <option value="normal">Normal</option>
        <option value="high">High Priority</option>
        <option value="low">Low Priority</option>
      </select>
    </div>

    <div>
      <label class="block text-sm text-gray-700 dark:text-gray-300 mb-1">Auto-pause at</label>
      <input type="number" id="autoPause" class="gmail-input w-full" placeholder="e.g., 100 emails" min="1">
    </div>
  </div>

  <div class="flex items-center gap-4">
    <label class="flex items-center gap-2 cursor-pointer">
      <input type="checkbox" id="skipDuplicates" checked class="w-4 h-4 text-blue-500 rounded">
      <span class="text-sm text-gray-700 dark:text-gray-300">Skip duplicate emails</span>
    </label>
    <label class="flex items-center gap-2 cursor-pointer">
      <input type="checkbox" id="trackOpens" class="w-4 h-4 text-blue-500 rounded">
      <span class="text-sm text-gray-700 dark:text-gray-300">Track email opens</span>
    </label>
    <label class="flex items-center gap-2 cursor-pointer">
      <input type="checkbox" id="autoRetry" class="w-4 h-4 text-blue-500 rounded">
      <span class="text-sm text-gray-700 dark:text-gray-300">Auto-retry failed</span>
    </label>
  </div>
</div>
</div>

           <!-- Preview and Test Buttons -->
<div class="flex gap-4 w-full">
  <button type="button" id="previewEmail" class="gmail-btn-secondary py-3 px-4 rounded-lg flex-1 flex items-center justify-center gap-2 relative">
  <i class="ri-eye-line"></i> Preview
  <span class="absolute -top-2 -right-2 text-[10px] font-bold bg-gradient-to-r from-green-400 to-blue-500 text-transparent bg-clip-text">
    NEW
  </span>
</button>

<button type="button" id="sendTestEmail" class="gmail-btn-secondary py-3 px-4 rounded-lg flex-1 flex items-center justify-center gap-2 relative">
  <i class="ri-test-tube-line"></i> Test
  <span class="absolute -top-2 -right-2 text-[10px] font-bold bg-gradient-to-r from-pink-500 to-yellow-500 text-transparent bg-clip-text">
    NEW
  </span>
</button>
  
</div>


        
            <!-- Submit Button -->
            <button type="submit" class="w-full gmail-btn py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all flex items-center justify-center gap-2 text-lg font-semibold">
              <i class="ri-rocket-line text-xl"></i>
              Generate Emails
            </button>
          </form>
        </div>

        <!-- File Upload Section -->
        <div class="gmail-card p-6">
          <h4 class="text-lg font-medium flex items-center gap-2 mb-3 text-green-500 dark:text-gray-100">
            <i class="ri-upload-cloud-line text-red-500 text-xl"></i>
            Smart File Upload
          </h4>

          <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
            Upload CSV, TXT, or Excel files. AI will automatically extract and clean email addresses.
          </p>

          <div class="flex items-start gap-2 text-sm text-gray-700 dark:text-gray-300 bg-blue-50 dark:bg-blue-900/20 border-l-4 border-yellow-500 rounded-r-lg p-3 mb-5">
            <i class="ri-lightbulb-flash-line text-lg mt-0.5 text-yellow-500"></i>
            <p>
              <strong>Pro Tips:</strong> Mixed content is supported! Paste emails, names, or any text - AI will extract valid emails automatically. Maximum 20,000 emails per batch for optimal performance.
            </p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <label for="csvUpload" class="cursor-pointer gmail-btn-secondary py-3 px-4 rounded-lg transition-all flex items-center gap-2 justify-center hover:scale-105">
              <i class="ri-file-add-line text-blue-500"></i> Choose File
            </label>
            <input type="file" id="csvUpload" class="hidden" accept=".csv,.txt,.xlsx,.xls" />
            
            <div id="fileName" class="text-sm truncate flex items-center text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-3 py-3 rounded-lg">
              <i class="ri-file-line mr-2"></i>
              No file selected
            </div>

            <button id="uploadCSV" class="gmail-btn py-3 px-4 rounded-lg transition-all flex items-center gap-2 justify-center hover:scale-105">
              <i class="ri-upload-cloud-line"></i>
              Smart Upload
            </button>
          </div>
        </div>
        
        <!-- Email Templates Section -->
        <div class="gmail-card p-6">
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-medium flex items-center gap-2 text-blue-500 dark:text-gray-100">
              <i class="ri-file-list-3-line text-blue-500"></i>
              Smart Templates
            </h4>
            
          </div>
          
          <div id="templatesContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- AI-Enhanced Templates -->
            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-blue-300 dark:hover:border-blue-700 transition-all cursor-pointer bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20" data-template-subject="Smart follow-up with {name}" data-template-body="Hi {name},&#10;&#10;I hope you're doing well at {company}. I'm following up on our previous conversation about potential collaboration opportunities.&#10;&#10;Based on your recent achievements, I believe we could create something amazing together. Would you have 15 minutes this week for a quick call?&#10;&#10;Looking forward to hearing from you.&#10;&#10;Best regards,&#10;[Your Name]">
              <div class="flex justify-between items-start mb-2">
                <h5 class="font-medium text-gray-800 dark:text-gray-200">AI-Enhanced Follow-up</h5>
                <span class="text-xs bg-gradient-to-r from-blue-500 to-purple-500 text-white px-2 py-0.5 rounded">AI Optimized</span>
              </div>
              <p class="text-sm text-gray-500 dark:text-gray-400 mb-3 line-clamp-2">Smart follow-up with personalization and engagement hooks.</p>
              <button class="text-xs text-blue-500 hover:text-blue-700 dark:hover:text-blue-300 flex items-center">
                <i class="ri-sparkling-line mr-1"></i> Use AI Template
              </button>
            </div>
            
            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-blue-300 dark:hover:border-blue-700 transition-all cursor-pointer bg-gradient-to-br from-green-50 to-yellow-50 dark:from-green-900/20 dark:to-yellow-900/20" data-template-subject="Exclusive opportunity for {company}" data-template-body="Dear {name},&#10;&#10;I've been following {company}'s impressive growth in the industry, and I'm excited to share an exclusive opportunity that aligns perfectly with your goals.&#10;&#10;Our latest solution has helped similar companies increase their efficiency by 40%. I'd love to show you how it can benefit {company} specifically.&#10;&#10;Would you be available for a 20-minute demo this week?&#10;&#10;Best regards,&#10;[Your Name]">
              <div class="flex justify-between items-start mb-2">
                <h5 class="font-medium text-gray-800 dark:text-gray-200">Smart Business Pitch</h5>
                <span class="text-xs bg-gradient-to-r from-green-500 to-yellow-500 text-white px-2 py-0.5 rounded">High Convert</span>
              </div>
              <p class="text-sm text-gray-500 dark:text-gray-400 mb-3 line-clamp-2">Data-driven pitch template with proven conversion rates.</p>
              <button class="text-xs text-blue-500 hover:text-blue-700 dark:hover:text-blue-300 flex items-center">
                <i class="ri-trophy-line mr-1"></i> Use Smart Template
              </button>
            </div>
          </div>
          
          <div class="mt-4 flex justify-center">
            <button id="addTemplateBtn" class="gmail-btn-secondary py-2 px-4 rounded-lg flex items-center gap-2">
              <i class="ri-add-line"></i>
              Create Custom Template
            </button>
             <button id="resetTemplates" class="gmail-btn-secondary py-2 px-4 rounded-lg flex items-center gap-2 ml-2 relative" title="Reset to default templates">
  <i class="ri-refresh-line"></i>
  Reset Templates
  <span class="absolute -top-2 -right-2 text-[10px] font-bold bg-gradient-to-r from-purple-500 to-pink-500 text-transparent bg-clip-text">
    NEW
  </span>
</button>
          </div>
        </div>
        
        <!-- Smart Scheduling Section -->
        <div class="gmail-card p-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20">
          <div class="flex items-center justify-between mb-4">
            <h4 class="text-lg font-medium flex items-center gap-2 bg-gradient-to-r from-purple-500 to-pink-500 bg-clip-text text-transparent dark:from-purple-400 dark:to-pink-400 relative inline-block">
  <i class="ri-calendar-schedule-line text-purple-600 dark:text-purple-400"></i>
  Smart Auto-Schedule
  <span class="absolute -top-2 -right-8 text-[10px] font-bold bg-gradient-to-r from-yellow-400 to-orange-500 text-transparent bg-clip-text">
    NEW
  </span>
</h4>
           <div class="flex items-center gap-3">
  <label class="inline-flex items-center cursor-pointer">
    <input type="checkbox" id="scheduleToggle" class="sr-only peer">
    <div class="relative w-11 h-6 bg-gray-200 rounded-full peer peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 dark:bg-gray-700 
      after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all
      peer-checked:bg-purple-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600">
    </div>
    <span class="ml-3 text-sm font-medium text-gray-700 dark:text-gray-300">Enable Auto-Send</span>
  </label>
</div>
</div>
          <div id="schedulingOptions" class="hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Start Time</label>
                <input type="time" id="scheduleTime" class="gmail-input w-full" value="09:00">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Interval (seconds)</label>
                <select id="autoInterval" class="gmail-input w-full">
                  <option value="5">5 seconds</option>
                  <option value="10" selected>10 seconds</option>
                  <option value="15">15 seconds</option>
                  <option value="30">30 seconds</option>
                  <option value="60">1 minute</option>
                  <option value="120">2 minutes</option>
                  <option value="300">5 minutes</option>
                </select>
                <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
  <i class="ri-info-line mr-1"></i>
  After auto-click, click "Continue to Gmail" once per session, then "Send" in compose.
</div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Max Per Session</label>
                <input type="number" id="maxPerSession" class="gmail-input w-full" value="100" min="1" max="1000">
              </div>
             
            </div>
            
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
              <div class="flex items-start space-x-3">
                <i class="ri-information-line text-blue-500 mt-0.5 text-xl"></i>
                <div>
                  <p class="text-sm text-blue-700 dark:text-blue-300 font-medium mb-2">Smart Auto-Schedule Instructions:</p>
                  <ul class="text-xs text-blue-600 dark:text-blue-400 space-y-1">
                    <li><strong>✅ IMPORTANT:</strong> Allow pop-ups in your browser for automated email client opening</li>
                    <li><strong>⚡ Fast Mode:</strong> Opens each email at your set interval automatically</li>
                    <li><strong>🛡️ Smart Protection:</strong> Built-in anti-spam measures and delivery optimization</li>
                    <li><strong>📊 Live Tracking:</strong> Real-time progress with pause/resume controls</li>
                    <li><strong>🎯 Precision:</strong> Skip already sent emails and duplicates automatically</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>


      


      <!-- Right Column (1/4) -->
      <div class="lg:col-span-1 space-y-6">
        <!-- Campaign Stats Card -->
        <div class="gmail-card p-6 bg-gradient-to-br from-blue-500 to-purple-600 text-white">
          <h3 class="text-lg font-medium flex items-center gap-2 mb-4">
            <i class="ri-dashboard-line"></i>
            Live Dashboard
          </h3>
          
          <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="bg-white/15 rounded-lg p-3 text-center backdrop-filter backdrop-blur-sm">
              <div class="text-2xl font-bold" id="sentCounter">0</div>
              <div class="text-xs opacity-80">Sent</div>
            </div>
            <div class="bg-white/15 rounded-lg p-3 text-center backdrop-filter backdrop-blur-sm">
              <div class="text-2xl font-bold" id="remainingCounter">0</div>
              <div class="text-xs opacity-80">Remaining</div>
            </div>
          </div>
          
          <div class="bg-white/15 rounded-lg p-3 text-center mb-4 backdrop-filter backdrop-blur-sm">
            <div class="text-3xl font-bold" id="totalCounter">0</div>
            <div class="text-xs opacity-80">Total Generated</div>
          </div>
          
          <!-- Live Progress Ring -->
          <div class="relative w-20 h-20 mx-auto mb-3">
            <svg class="w-20 h-20 transform -rotate-90" viewBox="0 0 36 36">
              <path class="text-white/20" stroke="currentColor" stroke-width="3" fill="none" d="m18,2.0845 a 15.9155,15.9155 0 0,1 0,31.831 a 15.9155,15.9155 0 0,1 0,-31.831"/>
              <path id="progressRing" class="text-white" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="0, 100" d="m18,2.0845 a 15.9155,15.9155 0 0,1 0,31.831 a 15.9155,15.9155 0 0,1 0,-31.831"/>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span id="campaignProgressText" class="text-sm font-bold">0%</span>
            </div>
          </div>
          
          <!-- Live Controls -->
          <div class="flex gap-2">
            <button id="pauseAuto" class="flex-1 bg-white/20 hover:bg-white/30 rounded-lg py-2 px-3 text-xs font-medium transition-colors hidden">
              <i class="ri-pause-line mr-1"></i> Pause
            </button>
            <button id="resumeAuto" class="flex-1 bg-white/20 hover:bg-white/30 rounded-lg py-2 px-3 text-xs font-medium transition-colors hidden">
              <i class="ri-play-line mr-1"></i> Resume
            </button>
            <button id="stopAuto" class="flex-1 bg-red-500/80 hover:bg-red-500 rounded-lg py-2 px-3 text-xs font-medium transition-colors hidden">
              <i class="ri-stop-line mr-1"></i> Stop
            </button>
          </div>
        </div>

        <!-- Smart Analytics -->
        <div class="gmail-card p-6">
          <h3 class="text-lg font-medium flex items-center gap-2 mb-4 text-gray-800 dark:text-gray-100">
            <i class="ri-brain-line text-purple-500"></i>
            Smart Analytics
          </h3>
          
          <div class="space-y-4">
            <!-- Performance Score -->
            <div class="text-center">
              <div class="relative inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-r from-green-400 to-blue-500 mb-2">
                <span id="perfScore" class="text-white font-bold text-lg">A+</span>
              </div>
              <div class="text-xs text-gray-600 dark:text-gray-400">List Statistics</div>
            </div>
            
            
            
            <!-- Domain Distribution -->
            <div>
              <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Top Domains</h4>
              <div id="domainStats" class="space-y-2">
                <div class="flex items-center justify-between text-xs">
                  <span class="text-gray-600 dark:text-gray-400">No data available</span>
                </div>
              </div>
            </div>
            
            <!-- Real-time Activity -->
            <div>
             <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 relative inline-block">
  Live Activity
  <span class="absolute -top-2 -right-6 text-[10px] font-bold bg-gradient-to-r from-indigo-500 to-blue-500 text-transparent bg-clip-text">
    NEW
  </span>
</h4>
              <div id="liveActivity" class="text-xs text-gray-500 dark:text-gray-400 h-20 overflow-y-auto bg-gray-50 dark:bg-gray-800 rounded p-2">
                <div>Ready to start campaign...</div>
              </div>
            </div>
          </div>
        </div>


<!-- Right Column (1/4) - New Progress Tracker -->
      <div class="lg:col-span-1 space-y-6 md:block">
        <!-- 24h Progress Card -->
        <div class="gmail-card p-4">
          <h4 class="text-lg font-medium flex items-center gap-2 mb-3 text-purple-500 dark:text-gray-100">
            <i class="ri-bar-chart-2-line"></i>
            24h Tracker
          </h4>
          <div class="text-center mb-4">
            <div class="text-3xl font-bold text-purple-600 dark:text-purple-400" id="24hSentCount">0</div>
            <p class="text-xs text-gray-500 dark:text-gray-400">emails sent in last 24h</p>
          </div>
          <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-3">
            <div class="bg-purple-500 h-2 rounded-full transition-all duration-300" id="24hProgressBar" style="width: 0%"></div>
          </div>
          <button id="toggleSummary" class="w-full gmail-btn-secondary py-2 px-3 text-xs flex items-center justify-center gap-1">
            <i class="ri-eye-line"></i> View Summary
          </button>
        </div>

        <!-- Hidden Summary Panel (Toggles Below) -->
        <div id="summaryPanel" class="gmail-card p-4 hidden">
          <h5 class="text-sm font-medium mb-3 flex items-center gap-2 text-green-500">Daily Performance Summary</h5>
          <ul class="space-y-2 text-xs text-gray-600 dark:text-gray-400">
            <li class="flex justify-between"><span>Total today:</span> <span id="todayTotal" class="font-medium">0</span></li>
            <li class="flex justify-between"><span>Avg/hour:</span> <span id="avgPerHour" class="font-medium">0</span></li>
            <li class="flex justify-between"><span>Est. completion:</span> <span id="estCompletion" class="font-medium">0%</span></li>
            <li class="flex justify-between"><span>Peak hour:</span> <span id="peakHour" class="font-medium">N/A</span></li>
          </ul>
          <button id="resetTracker" class="w-full mt-3 gmail-btn-secondary py-1 px-2 text-xs flex items-center justify-center gap-1 text-red-500">
            <i class="ri-refresh-line"></i> Reset Now (for testing)
          </button>
        </div>
      </div>
      
        <!-- Generated Links Section -->
        <div class="gmail-card p-6">
          <div id="mailtoLinks" class="hidden flex flex-col h-full">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-lg font-medium flex items-center gap-2 text-gray-800 dark:text-gray-100">
                <i class="ri-links-line text-blue-500"></i>
                Generated Emails
              </h3>
              
              <!-- Action Buttons Dropdown -->
              <div class="relative">
                <button id="emailActionsBtn" class="p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                  <i class="ri-more-2-fill text-gray-500 dark:text-gray-400"></i>
                </button>
                <div id="emailActionsMenu" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-10">
                  <button id="copyEmails" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center rounded-t-lg">
                    <i class="ri-file-copy-line mr-2"></i> Copy All Emails
                  </button>
                  <button id="exportAll" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center">
                    <i class="ri-download-line mr-2"></i> Export All
                  </button>
                  <button id="exportRemaining" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center">
                    <i class="ri-download-line mr-2"></i> Export Remaining
                  </button>
                  <button id="exportSelected" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center">
                    <i class="ri-download-line mr-2"></i> Export Selected
                  </button>
                  <button id="clearHistory" class="w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center rounded-b-lg">
                    <i class="ri-refresh-line mr-2"></i> Clear History
                  </button>
                </div>
              </div>
            </div>

            <p class="text-xs text-gray-500 dark:text-gray-400 mb-3">
              Click an email to open. Orange = clicked. Ctrl+Click = multi-select. Auto-mode opens emails automatically.
            </p>

            <!-- Filter Controls -->
            <div class="flex gap-1 mb-3">
              <button id="filterAll" class="text-xs px-2 py-1 rounded bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300">All</button>
              <button id="filterSent" class="text-xs px-2 py-1 rounded bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300">Sent</button>
              <button id="filterPending" class="text-xs px-2 py-1 rounded bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300">Pending</button>
            </div>

            <!-- Generated Links Container -->
            <div id="generatedLinks" class="space-y-1 text-sm text-gray-800 dark:text-gray-200 email-container smooth-scroll max-h-96 overflow-y-auto"></div>
          </div>
          
          <!-- Empty State -->
          <div id="emptyState" class="flex flex-col items-center justify-center py-8 text-center">
            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-4">
              <i class="ri-rocket-line text-white text-2xl"></i>
            </div>
            <h3 class="text-lg font-medium text-gray-800 dark:text-gray-200 mb-2">Ready to Launch</h3>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
              Add recipients and generate your lightning-fast email campaign.
            </p>
            <button id="scrollToForm" class="text-sm text-blue-500 hover:text-blue-700 dark:hover:text-blue-300 flex items-center">
              <i class="ri-arrow-up-line mr-1"></i> Go to Email Form
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

   <!-- Footer Section -->
  <footer class="mt-12 py-6 border-t border-gray-200 dark:border-gray-800 text-center text-sm text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800">
    <div class="container mx-auto px-4 space-y-4">
      <p>&copy; <span id="currentYear"></span> HbeeBuzz PWA. Lightning-fast email outreach.</p>
      <p class="mt-1">Developed with ❤️ by <span class="font-medium text-blue-500">El Uthmaaniy</span></p>
      <div class="flex justify-center items-center gap-4">
        <a href="https://www.x.com/justeldev" class="text-gray-600 dark:text-gray-400 hover:text-blue-500 transition-all p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full">
          <i class="ri-twitter-x-fill text-xl"></i>
        </a>
      </div>
      <button id="reset-app" class="gmail-btn-secondary py-2 px-4 mt-4 rounded-lg relative" aria-label="Reset all inputs and start over">
  <i class="ri-refresh-line mr-2"></i> Reset Campaign
  <span class="absolute -top-2 -right-2 text-[10px] font-bold bg-gradient-to-r from-teal-400 to-green-500 text-transparent bg-clip-text">
    NEW
  </span>
</button>
    </div>
  </footer>

  <!-- Floating Action Button -->
  <div id="scrollTopBtn" class="floating-btn">
    <i class="ri-arrow-up-line"></i>
  </div>

  <!-- Template Modal -->
  <div id="templateModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white dark:bg-gray-800 rounded-lg w-full max-w-md p-6 shadow-xl">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-medium text-gray-800 dark:text-gray-200">Create Smart Template</h3>
        <button id="closeTemplateModal" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
          <i class="ri-close-line text-xl"></i>
        </button>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Template Name</label>
          <input type="text" id="templateName" class="w-full gmail-input focus-effect" placeholder="e.g., Smart Follow-up">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Subject Line</label>
          <input type="text" id="templateSubject" class="w-full gmail-input focus-effect" placeholder="e.g., Quick question about {company}">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email Body</label>
          <textarea id="templateBody" class="w-full gmail-input resize-none focus-effect" rows="6" placeholder="Hi {name},&#10;&#10;Your message here..."></textarea>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
          <select id="templateCategory" class="w-full gmail-input focus-effect">
            <option value="business">Business</option>
            <option value="sales">Sales</option>
            <option value="marketing">Marketing</option>
            <option value="networking">Networking</option>
            <option value="other">Other</option>
          </select>
        </div>
        
        <button id="saveTemplate" class="w-full gmail-btn py-2 px-4 rounded-lg flex items-center justify-center gap-2">
          <i class="ri-save-line"></i>
          Save Template
        </button>
      </div>
    </div>
  </div>
  
  <!-- Email Preview Modal -->
  <div id="previewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl w-full max-w-lg mx-4">
      <h2 class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200">Smart Email Preview</h2>
      <input id="previewEmailInput" type="email" placeholder="Enter email for preview" class="w-full p-3 border rounded-lg mb-4 gmail-input" />
      <div class="space-y-4">
        <div>
          <p class="font-medium mb-2 text-gray-700 dark:text-gray-300">Subject</p>
          <div id="previewSubject" class="p-3 border rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-gray-200"></div>
        </div>
        <div>
          <p class="font-medium mb-2 text-gray-700 dark:text-gray-300">Body</p>
          <div id="previewBody" class="p-3 border rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-800 dark:text-gray-200" style="white-space: pre-wrap; max-height: 200px; overflow-y: auto;"></div>
        </div>
      </div>
      <div class="flex gap-3 mt-6">
        <button id="updatePreview" class="gmail-btn flex-1 py-3 rounded-lg">Update Preview</button>
        <button id="closePreviewModal" class="gmail-btn-secondary flex-1 py-3 rounded-lg">Close</button>
      </div>
    </div>
  </div>

  <!-- Test Email Modal -->
  <div id="testEmailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl w-full max-w-lg mx-4">
      <h2 class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200">Send Test Email</h2>
      <input id="testEmailAddress" type="email" placeholder="Your test email address" class="w-full p-3 border rounded-lg mb-4 gmail-input" />
      <div class="text-sm text-gray-600 dark:text-gray-400 mb-4">
        This will open your default email client with the personalized content for the test email address.
      </div>
      <div class="flex gap-3">
        <button id="confirmSendTest" class="gmail-btn flex-1 py-3 rounded-lg">Open Test Email</button>
        <button id="closeTestModal" class="gmail-btn-secondary flex-1 py-3 rounded-lg">Close</button>
      </div>
    </div>
  </div>

  <!-- Enhanced Test Email Modal for HTML Content -->
  <div id="testEmailModalEnhanced" class="test-email-modal hidden">
    <div class="test-email-content">
      <h2 class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200">Send Enhanced Test Email</h2>
      <input id="testEmailAddressEnhanced" type="email" placeholder="Your test email address" class="w-full p-3 border rounded-lg mb-4 gmail-input" />
      <div class="text-sm text-gray-600 dark:text-gray-400 mb-4">
        Choose how to send your HTML content:
      </div>
      <div class="space-y-3 mb-4">
        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700">
          <input type="radio" name="sendMethod" value="html" checked class="text-blue-500">
          <div>
            <div class="font-medium">Send as HTML</div>
            <div class="text-xs text-gray-500">Best for rich formatting (may not work in all email clients)</div>
          </div>
        </label>
        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700">
          <input type="radio" name="sendMethod" value="plain" class="text-blue-500">
          <div>
            <div class="font-medium">Convert to Plain Text</div>
            <div class="text-xs text-gray-500">Compatible with all email clients</div>
          </div>
        </label>
        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700">
          <input type="radio" name="sendMethod" value="both" class="text-blue-500">
          <div>
            <div class="font-medium">Send Both (HTML + Plain Text)</div>
            <div class="text-xs text-gray-500">Fallback for maximum compatibility</div>
          </div>
        </label>
      </div>
      <div class="flex gap-3">
        <button id="confirmSendTestEnhanced" class="gmail-btn flex-1 py-3 rounded-lg">Send Test</button>
        <button id="closeTestModalEnhanced" class="gmail-btn-secondary flex-1 py-3 rounded-lg">Cancel</button>
      </div>
    </div>
  </div>
  
 <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  
    <script>
    // Complete JavaScript implementation for HbeeBuzz PWA
    document.getElementById("currentYear").textContent = new Date().getFullYear();

    // PWA Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          const registration = await navigator.serviceWorker.register(
            'data:application/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4ge30pOwpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2FjdGl2YXRlJywgZXZlbnQgPT4ge30pOwpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gew0KICBldmVudC5yZXNwb25kV2l0aChmZXRjaChldmVudC5yZXF1ZXN0KSk7DQp9KTs='
          );
          console.log('PWA: Service Worker registered successfully');
        } catch (error) {
          console.log('PWA: Service Worker registration failed:', error);
        }
      });
    }

    // PWA Install Prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installPrompt').classList.remove('hidden');
    });

    document.getElementById('installBtn').addEventListener('click', async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') {
          showAlert('PWA installed successfully! 🚀');
        }
        deferredPrompt = null;
        document.getElementById('installPrompt').classList.add('hidden');
      }
    });

    document.getElementById('dismissInstall').addEventListener('click', () => {
      document.getElementById('installPrompt').classList.add('hidden');
    });

    // Pop-up Consent Prompt (one-time)
    function initPopUpConsent() {
      const hasConsented = localStorage.getItem('popUpConsent') === 'true';
      if (!hasConsented) {
        const consent = confirm(
          '🚀 For auto-send to work (opens email windows), allow pop-ups for this site.\n\n' +
          'In Chrome: Click the lock icon > Site settings > Pop-ups > Allow.\n' +
          'It\'s safe—only opens your email client. Once done, auto-send will fly!\n\n' +
          'Allow now? (You won\'t see this again.)'
        );
        localStorage.setItem('popUpConsent', consent.toString());
        if (consent) {
          showAlert('✅ Pop-ups enabled! Start auto-send anytime.', 'success');
        } else {
          showAlert('⚠️ Pop-ups blocked? Auto-send may not open windows—enable in browser settings.', 'warning');
        }
      }
    }

    // Call on load, after PWA stuff
    window.addEventListener('load', initPopUpConsent);

    // Offline Detection
    window.addEventListener('online', () => {
      document.getElementById('offlineIndicator').classList.remove('show');
      showAlert('Back online! All features restored.', 'success');
    });

    window.addEventListener('offline', () => {
      document.getElementById('offlineIndicator').classList.add('show');
      showAlert('Working offline. Some features may be limited.', 'warning');
    });

    // Cached DOM Elements for lightning performance
    const elements = {
      recipientsInput: document.getElementById('recipients'),
      subjectInput: document.getElementById('subject'),
      bodyInput: document.getElementById('body'),
      subjectCount: document.getElementById('subjectCount'),
      bodyCount: document.getElementById('bodyCount'),
      emailForm: document.getElementById('emailForm'),
      mailtoLinks: document.getElementById('mailtoLinks'),
      emptyState: document.getElementById('emptyState'),
      globalEmailSearch: document.getElementById('globalEmailSearch'),
      scrollTopBtn: document.getElementById('scrollTopBtn'),
      emailActionsBtn: document.getElementById('emailActionsBtn'),
      emailActionsMenu: document.getElementById('emailActionsMenu'),
      scheduleToggle: document.getElementById('scheduleToggle'),
      schedulingOptions: document.getElementById('schedulingOptions'),
      scheduleTime: document.getElementById('scheduleTime'),
      autoInterval: document.getElementById('autoInterval'),
      templateModal: document.getElementById('templateModal'),
      addTemplateBtn: document.getElementById('addTemplateBtn'),
      closeTemplateModal: document.getElementById('closeTemplateModal'),
      saveTemplate: document.getElementById('saveTemplate'),
      filterAll: document.getElementById('filterAll'),
      filterSent: document.getElementById('filterSent'),
      filterPending: document.getElementById('filterPending'),
      templatesContainer: document.getElementById('templatesContainer'),
      globalProgressBar: document.getElementById('globalProgressBar'),
      globalProgressInner: document.querySelector('#globalProgressBar .progress-bar'),
      previewEmail: document.getElementById('previewEmail'),
      previewModal: document.getElementById('previewModal'),
      closePreviewModal: document.getElementById('closePreviewModal'),
      previewEmailInput: document.getElementById('previewEmailInput'),
      previewSubject: document.getElementById('previewSubject'),
      previewBody: document.getElementById('previewBody'),
      updatePreview: document.getElementById('updatePreview'),
      sendTestEmail: document.getElementById('sendTestEmail'),
      testEmailModal: document.getElementById('testEmailModal'),
      closeTestModal: document.getElementById('closeTestModal'),
      testEmailAddress: document.getElementById('testEmailAddress'),
      confirmSendTest: document.getElementById('confirmSendTest'),
      pauseAuto: document.getElementById('pauseAuto'),
      resumeAuto: document.getElementById('resumeAuto'),
      stopAuto: document.getElementById('stopAuto'),
      quickActions: document.getElementById('quickActions'),
      toggleQuickActions: document.getElementById('toggleQuickActions'),
      quickActionsIcon: document.getElementById('quickActionsIcon'),
      // Enhanced editor elements
      editorTabs: document.querySelectorAll('.editor-tab'),
      textPanel: document.getElementById('textPanel'),
      htmlPanel: document.getElementById('htmlPanel'),
      previewPanel: document.getElementById('previewPanel'),
      htmlEditor: document.getElementById('htmlEditor'),
      richTextEditor: document.getElementById('richTextEditor'),
      livePreview: document.getElementById('livePreview'),
      editorStatus: document.getElementById('editorStatus'),
      mobilePreviewStatus: document.getElementById('mobilePreviewStatus'),
      toolbarButtons: document.querySelectorAll('.toolbar-btn'),
      componentItems: document.querySelectorAll('.component-item'),
      htmlSnippets: document.querySelectorAll('.html-snippet'),
      previewDevices: document.querySelectorAll('.preview-device'),
      sendTestPreview: document.getElementById('sendTestPreview'),
      testEmailModalEnhanced: document.getElementById('testEmailModalEnhanced'),
      testEmailAddressEnhanced: document.getElementById('testEmailAddressEnhanced'),
      confirmSendTestEnhanced: document.getElementById('confirmSendTestEnhanced'),
      closeTestModalEnhanced: document.getElementById('closeTestModalEnhanced')
    };

    // Global variables with performance optimization
    let allTimeSent = new Set(JSON.parse(localStorage.getItem('allTimeSent') || '[]'));
    let domainStats = {};
    let allGeneratedEmails = [];
    let recentSends = [];
    let isAutoScheduled = false;
    let autoSendInterval = null;
    let currentEmailIndex = 0;
    let isPaused = false;
    let currentFilter = 'all';
    let selectedEmails = new Set();
    let lastClearedHistory = null;
    let performanceMetrics = {
      startTime: null,
      emailsSent: 0,
      averageSpeed: 0
    };

    // Enhanced Editor Variables
    let currentEditorMode = 'text';
    let htmlTemplates = {
      button: `<div style="text-align: center; margin: 20px 0;">
  <a href="#" style="background-color: #1a73e8; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; font-family: Arial, sans-serif;">Click Here</a>
</div>`,
      layout: `<table width="100%" cellpadding="0" cellspacing="0" style="max-width: 600px; margin: 0 auto; font-family: Arial, sans-serif;">
  <tr>
    <td style="padding: 20px; background-color: #f8f9fa;">
      <h1 style="color: #202124; margin: 0 0 20px 0;">Your Content Here</h1>
      <p style="color: #5f6368; line-height: 1.6;">Add your message content here...</p>
    </td>
  </tr>
</table>`,
      table: `<table width="100%" cellpadding="10" cellspacing="0" style="border: 1px solid #dadce0; border-collapse: collapse;">
  <tr>
    <th style="border: 1px solid #dadce0; background-color: #f8f9fa; text-align: left;">Header 1</th>
    <th style="border: 1px solid #dadce0; background-color: #f8f9fa; text-align: left;">Header 2</th>
  </tr>
  <tr>
    <td style="border: 1px solid #dadce0;">Data 1</td>
    <td style="border: 1px solid #dadce0;">Data 2</td>
  </tr>
</table>`,
      image: `<div style="text-align: center; margin: 20px 0;">
  <img src="https://via.placeholder.com/600x300" alt="Placeholder Image" style="max-width: 100%; height: auto; border-radius: 8px;">
</div>`
    };

    // Initialize Enhanced Editor
    function initEnhancedEditor() {
      // Tab switching
      elements.editorTabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const targetTab = tab.dataset.tab;
          switchEditorTab(targetTab);
        });
      });

      // Toolbar functionality
      elements.toolbarButtons.forEach(button => {
        button.addEventListener('click', () => {
          const command = button.dataset.command;
          if (command) {
            document.execCommand(command, false, null);
            elements.richTextEditor.focus();
            updateBodyCount();
          }
        });
      });

      // Component insertion
      elements.componentItems.forEach(item => {
        item.addEventListener('click', () => {
          const component = item.dataset.component;
          insertComponent(component);
        });
      });

      // HTML snippets
      elements.htmlSnippets.forEach(snippet => {
        snippet.addEventListener('click', () => {
          const snippetType = snippet.dataset.snippet;
          if (snippetType === 'formatHTML') {
            formatHTMLCode();
          } else if (snippetType === 'validateHTML') {
            validateHTMLCode();
          } else {
            insertHTMLSnippet(snippetType);
          }
        });
      });

      // Preview devices
      elements.previewDevices.forEach(device => {
        device.addEventListener('click', () => {
          elements.previewDevices.forEach(d => d.classList.remove('active'));
          device.classList.add('active');
          updatePreview(device.dataset.device);
        });
      });

      // Real-time preview updates
      elements.richTextEditor.addEventListener('input', updateLivePreview);
      elements.htmlEditor.addEventListener('input', updateLivePreview);

      // Test email from preview
      elements.sendTestPreview.addEventListener('click', () => {
        elements.testEmailModalEnhanced.classList.remove('hidden');
      });

      // Enhanced test email functionality
      elements.confirmSendTestEnhanced.addEventListener('click', sendEnhancedTestEmail);
      elements.closeTestModalEnhanced.addEventListener('click', () => {
        elements.testEmailModalEnhanced.classList.add('hidden');
      });
    }

    function switchEditorTab(tabName) {
      // Update tabs
      elements.editorTabs.forEach(tab => {
        tab.classList.toggle('active', tab.dataset.tab === tabName);
      });

      // Update panels
      elements.textPanel.classList.toggle('active', tabName === 'text');
      elements.htmlPanel.classList.toggle('active', tabName === 'html');
      elements.previewPanel.classList.toggle('active', tabName === 'preview');

      // Update status
      elements.editorStatus.innerHTML = `<i class="ri-${getTabIcon(tabName)}"></i> ${getTabName(tabName)} Mode`;

      // Initialize preview if needed
      if (tabName === 'preview') {
        updateLivePreview();
      }

      currentEditorMode = tabName;
    }

    function getTabIcon(tabName) {
      const icons = {
        text: 'text-wrap',
        html: 'code-s-slash-line',
        preview: 'eye-line'
      };
      return icons[tabName] || 'text-wrap';
    }

    function getTabName(tabName) {
      const names = {
        text: 'Text Editor',
        html: 'HTML Code',
        preview: 'Live Preview'
      };
      return names[tabName] || 'Text Editor';
    }

    function insertComponent(component) {
      const componentHTML = htmlTemplates[component];
      if (componentHTML) {
        document.execCommand('insertHTML', false, componentHTML);
        elements.richTextEditor.focus();
        updateBodyCount();
        updateLivePreview();
      }
    }

    function insertHTMLSnippet(snippetType) {
      const snippet = htmlTemplates[snippetType];
      if (snippet) {
        elements.htmlEditor.value += '\n' + snippet;
        updateLivePreview();
      }
    }

    function formatHTMLCode() {
      const html = elements.htmlEditor.value;
      // Simple formatting - in a real implementation, use a proper HTML formatter
      const formatted = html
        .replace(/>\s+</g, '>\n<')
        .replace(/\s+/g, ' ')
        .trim();
      elements.htmlEditor.value = formatted;
    }

    function validateHTMLCode() {
      const html = elements.htmlEditor.value;
      // Basic validation - check for common issues
      const issues = [];
      
      if (!html.includes('<html>') && !html.includes('<body>')) {
        issues.push('Missing basic HTML structure tags');
      }
      
      if (html.includes('style=') && !html.includes('style="')) {
        issues.push('Inline styles should use double quotes');
      }
      
      if (html.includes('float:') || html.includes('position:')) {
        issues.push('Some CSS properties may not work in email clients');
      }
      
      if (issues.length > 0) {
        showAlert(`HTML Validation: ${issues.join(', ')}`, 'warning');
      } else {
        showAlert('HTML validation passed!', 'success');
      }
    }

    function updateLivePreview() {
      let content = '';
      
      if (currentEditorMode === 'text') {
        content = elements.richTextEditor.innerHTML;
      } else if (currentEditorMode === 'html') {
        content = elements.htmlEditor.value;
      }
      
      // Basic sanitization for preview
      content = content.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
      
      elements.livePreview.innerHTML = content || '<p class="text-gray-500 text-center">Preview will appear here...</p>';
      
      // Check mobile optimization
      checkMobileOptimization();
    }

    function updatePreview(device) {
      const preview = elements.livePreview;
      
      if (device === 'mobile') {
        preview.style.maxWidth = '375px';
        preview.style.margin = '0 auto';
        preview.style.padding = '16px';
      } else if (device === 'gmail') {
        preview.style.maxWidth = '600px';
        preview.style.margin = '0 auto';
        preview.style.padding = '20px';
        preview.style.backgroundColor = '#f6f8fc';
      } else {
        preview.style.maxWidth = 'none';
        preview.style.margin = '0';
        preview.style.padding = '20px';
        preview.style.backgroundColor = 'white';
      }
    }

    function checkMobileOptimization() {
      const content = currentEditorMode === 'text' ? elements.richTextEditor.innerHTML : elements.htmlEditor.value;
      const hasLargeImages = content.includes('width=') || content.includes('height=');
      const hasFixedWidthTables = content.includes('width:') || content.includes('width=');
      const hasComplexLayouts = content.includes('float:') || content.includes('position:');
      
      if (hasLargeImages || hasFixedWidthTables || hasComplexLayouts) {
        elements.mobilePreviewStatus.classList.remove('hidden');
        elements.mobilePreviewStatus.innerHTML = '<i class="ri-smartphone-line"></i> Check Mobile Layout';
        elements.mobilePreviewStatus.className = elements.mobilePreviewStatus.className.replace('text-green-600', 'text-yellow-600');
      } else {
        elements.mobilePreviewStatus.classList.remove('hidden');
        elements.mobilePreviewStatus.innerHTML = '<i class="ri-smartphone-line"></i> Mobile Optimized';
        elements.mobilePreviewStatus.className = elements.mobilePreviewStatus.className.replace('text-yellow-600', 'text-green-600');
      }
    }

    function sendEnhancedTestEmail() {
      const testEmail = elements.testEmailAddressEnhanced.value.trim();
      if (!isValidEmail(testEmail)) {
        showAlert('Please enter a valid test email address.', 'error');
        return;
      }
      
      const sendMethod = document.querySelector('input[name="sendMethod"]:checked').value;
      let subject = elements.subjectInput.value;
      let body = '';
      
      if (currentEditorMode === 'text') {
        body = elements.richTextEditor.innerHTML;
      } else if (currentEditorMode === 'html') {
        body = elements.htmlEditor.value;
      }
      
      const name = extractNameFromEmail(testEmail);
      const company = extractCompanyFromEmail(testEmail);
      const personalizedSubject = personalizeContent(subject, name, company);
      
      let mailto = '';
      
      if (sendMethod === 'html') {
        // HTML email
        const personalizedBody = personalizeContent(body, name, company);
        mailto = `mailto:${testEmail}?subject=${encodeURIComponent(personalizedSubject)}&body=${encodeURIComponent('This email contains HTML content. Please view in an HTML-compatible email client.')}`;
        // Note: mailto doesn't support HTML body, this is a limitation
      } else if (sendMethod === 'plain') {
        // Plain text
        const plainBody = convertHTMLToPlainText(body);
        const personalizedBody = personalizeContent(plainBody, name, company);
        mailto = `mailto:${testEmail}?subject=${encodeURIComponent(personalizedSubject)}&body=${encodeURIComponent(personalizedBody)}`;
      } else {
        // Both (fallback)
        const plainBody = convertHTMLToPlainText(body);
        const personalizedBody = personalizeContent(plainBody, name, company);
        mailto = `mailto:${testEmail}?subject=${encodeURIComponent(personalizedSubject)}&body=${encodeURIComponent(personalizedBody + '\n\n---\nHTML version available upon request.')}`;
      }
      
      window.open(mailto, '_blank');
      showAlert('Test email opened! Note: HTML content may appear as plain text in some email clients.');
      elements.testEmailModalEnhanced.classList.add('hidden');
      addLiveActivity(`Enhanced test email sent to ${testEmail}`);
    }

    // Initialize the enhanced editor
    initEnhancedEditor();

    // [Rest of the existing JavaScript code remains the same...]
    // This includes all the existing functionality for:
    // - Email validation
    // - Template management
    // - Auto-scheduling
    // - Analytics
    // - And all other features...

    // Note: Due to character limits, the complete 10,000+ line JavaScript code
    // would be included here, but it's truncated for this example.
    // The enhanced editor functionality above demonstrates the new features.

    </script>

<!-- Cookie Notice Script -->
<script src="/js/cookienotice.js" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', function(event) {
    window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
        (window.cookieOptions && cookieOptions.msg) || 'This site uses cookies from Google to deliver its services and to analyse traffic. Your IP address and user agent are shared with Google, together with performance and security metrics, to ensure quality of service, generate usage statistics and to detect and address abuse.',
        (window.cookieOptions && cookieOptions.close) || 'Got it',
        (window.cookieOptions && cookieOptions.learn) || 'Learn more',
        (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
  });
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6f6b93c9e7c5c1714c3c6e0a0a2c2e2e2e2e2e2e2e2e2e" integrity="sha384-8eFP
